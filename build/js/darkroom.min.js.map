{"version":3,"file":"build/js/darkroom.min.js","sources":["build/lib/js/darkroom.js","build/lib/js/plugins/darkroom.history.js","build/lib/js/plugins/darkroom.rotate.js","build/lib/js/plugins/darkroom.crop.js","build/lib/js/plugins/darkroom.save.js"],"names":["window","document","fabric","extend","b","a","prop","undefined","hasOwnProperty","Darkroom","element","options","plugins","this","init","Plugin","darkroom","defaults","initialize","Toolbar","actionsElement","querySelector","ButtonGroup","Button","prototype","protoProps","child","parent","constructor","apply","arguments","Surrogate","__super__","createButtonGroup","buttonGroup","createElement","className","appendChild","createButton","image","type","group","hide","disabled","button","innerHTML","disable","addEventListener","eventName","callback","el","attachEvent","active","value","classList","add","remove","Canvas","util","createClass","minWidth","minHeight","maxWidth","maxHeight","backgroundColor","canvas","getElement","dispatchEvent","event","createEvent","initEvent","_this","Image","onload","createFabricImage","initDOM","initPlugins","bind","call","src","toolbar","canvasContainer","container","parentNode","replaceChild","selection","setWidth","getWidth","setHeight","getHeight","centerObject","setCoords","imgElement","width","height","scaleMin","scaleMax","scaleX","scaleY","Math","min","max","scale","selectable","evented","lockMovementX","lockMovementY","lockRotation","lockScalingX","lockScalingY","lockUniScaling","hasControls","hasBorders","setScaleX","setScaleY","imageSource","name","plugin","getPlugin","selfDestroy","snapshotImage","toDataURL","snapshotImageSource","_initButtons","backHistoryStack","backHistoryStackSource","forwardHistoryStack","forwardHistoryStackSource","_snapshotImage","_onImageChange","goBack","length","push","currentImage","currentImageSource","pop","_applyImage","_applyImageSource","_updateButtons","goForward","backButton","forwardButton","imgInstance","leftButton","rightButton","rotateLeft","rotateRight","rotate","angle","getAngle","abs","sin","PI","cos","renderAll","CropZone","Rect","_render","ctx","callSuper","dashWidth","flipX","flipY","fillStyle","_renderOverlay","setLineDash","mozDash","strokeStyle","_renderBorders","_renderGrid","lineDashOffset","borderOffset","x0","ceil","getLeft","x1","x2","x3","y0","getTop","y1","y2","y3","fillRect","beginPath","moveTo","lineTo","stroke","startX","startY","isKeyCroping","isKeyLeft","isKeyUp","ratio","quickCropKey","cropButton","okButton","cancelButton","toggleCrop","cropCurrentZone","releaseFocus","on","onMouseDown","onMouseMove","onMouseUp","onObjectMoving","onObjectScaling","addListener","onKeyDown","onKeyUp","hasFocus","currentObject","target","cropZone","x","y","w","h","maxX","maxY","set","preventScaling","pointer","getPointer","e","minX","minY","lastScaleX","setLeft","lastScaleY","setTop","scaleToWidth","scaleToHeight","getScaleX","getScaleY","calcOffset","point","Point","activeObject","getActiveObject","containsPoint","discardActiveObject","onMouseMoveKeyCrop","_renderCropZone","zone","left","top","setActiveObject","keyCode","selectZone","forceDimension","requireFocus","bringToFront","totalOnLoad","visible","imgSourceInstance","fill","originX","originY","cornerColor","cornerSize","transparentCorners","hasRotatingPoint","defaultCursor","fromX","fromY","toX","toY","isRight","isLeft","isDown","isUp","leftX","rightX","topY","bottomY","currentRatio","newWidth","newHeight","destroyButton"],"mappings":"CAOC,SAAUA,OAAQC,SAAUC,QAC3B,YAMA,SAASC,QAAOC,EAAGC,GACjB,GAAIC,KACJ,IAAUC,SAANH,EACF,MAAOC,EAET,KAAKC,OAAQD,GACPA,EAAEG,eAAeF,OAASF,EAAEI,eAAeF,SAAU,IACvDF,EAAEE,MAAQD,EAAEC,MAGhB,OAAOF,GAUT,QAASK,UAASC,QAASC,QAASC,SAClC,MAAOC,MAAKC,KAAKJ,QAASC,QAASC,SAarC,QAASG,QAAOC,SAAUL,SACxBE,KAAKG,SAAWA,SAChBH,KAAKF,QAAUR,OAAOQ,QAASE,KAAKI,UACpCJ,KAAKK,aAuCP,QAASC,SAAQT,SACfG,KAAKH,QAAUA,QACfG,KAAKO,eAAiBV,QAAQW,cAAc,6BAa9C,QAASC,aAAYZ,SACnBG,KAAKH,QAAUA,QA2BjB,QAASa,QAAOb,SACdG,KAAKH,QAAUA,QA/FjBV,OAAOS,SAAWA,SAKlBA,SAASG,WAUTG,OAAOS,WACLP,YACAC,WAAY,cAIdH,OAAOZ,OAAS,SAASsB,YACvB,GACIC,OADAC,OAASd,IAIXa,OADED,YAAcA,WAAWjB,eAAe,eAClCiB,WAAWG,YAEX,WAAY,MAAOD,QAAOE,MAAMhB,KAAMiB,YAGhD3B,OAAOuB,MAAOC,OAEd,IAAII,WAAY,WAAYlB,KAAKe,YAAcF,MAQ/C,OAPAK,WAAUP,UAAYG,OAAOH,UAC7BE,MAAMF,UAAY,GAAIO,WAElBN,YAAYtB,OAAOuB,MAAMF,UAAWC,YAExCC,MAAMM,UAAYL,OAAOH,UAElBE,OAITjB,SAASM,OAASA,OAWlBI,QAAQK,UAAUS,kBAAoB,WACpC,GAAIC,aAAcjC,SAASkC,cAAc,KAKzC,OAJAD,aAAYE,UAAY,wBAExBvB,KAAKO,eAAeiB,YAAYH,aAEzB,GAAIZ,aAAYY,cAQzBZ,YAAYE,UAAUc,aAAe,SAAS3B,SAC5C,GAAIM,WACFsB,MAAO,OACPC,KAAM,UACNC,MAAO,UACPC,MAAM,EACNC,UAAU,EAGZhC,SAAUR,OAAOQ,QAASM,SAE1B,IAAI2B,QAAS3C,SAASkC,cAAc,SACpCS,QAAOR,UAAY,mCAAqCzB,QAAQ6B,KAChEI,OAAOC,UAAY,2BAA6BlC,QAAQ4B,MAAQ,SAChE1B,KAAKH,QAAQ2B,YAAYO,OAEzB,IAAIA,QAAS,GAAIrB,QAAOqB,OAIxB,OAHAA,QAAOF,KAAK/B,QAAQ+B,MACpBE,OAAOE,QAAQnC,QAAQgC,UAEhBC,QAOTrB,OAAOC,WACLuB,iBAAkB,SAASC,UAAWC,UACpC,GAAIC,IAAKrC,KAAKH,OACVwC,IAAGH,iBACLG,GAAGH,iBAAiBC,UAAWC,UACtBC,GAAGC,aACZD,GAAGC,YAAY,KAAOH,UAAWC,WAGrCG,OAAQ,SAASC,OACXA,MACFxC,KAAKH,QAAQ4C,UAAUC,IAAI,0BAE3B1C,KAAKH,QAAQ4C,UAAUE,OAAO,2BAElCd,KAAM,SAASW,OACTA,MACFxC,KAAKH,QAAQ4C,UAAUC,IAAI,0BAE3B1C,KAAKH,QAAQ4C,UAAUE,OAAO,2BAElCV,QAAS,SAASO,OAChBxC,KAAKH,QAAQiC,SAAW,OAAU,GAAO,GAK7C,IAAIc,QAASvD,OAAOwD,KAAKC,YAAYzD,OAAOuD,UAM5ChD,UAASe,WAOPP,UAEE2C,SAAU,KACVC,UAAW,KACXC,SAAU,KACVC,UAAW,KACXC,gBAAiB,OAGjBpD,WAGAE,KAAM,cAKRiC,iBAAkB,SAASC,UAAWC,UACpC,GAAIC,IAAKrC,KAAKoD,OAAOC,YACjBhB,IAAGH,iBACLG,GAAGH,iBAAiBC,UAAWC,UACtBC,GAAGC,aACZD,GAAGC,YAAY,KAAOH,UAAWC,WAGrCkB,cAAe,SAASnB,WAGtB,GAAIoB,OAAQnE,SAASoE,YAAY,QACjCD,OAAME,UAAUtB,WAAW,GAAM,GAEjCnC,KAAKoD,OAAOC,aAAaC,cAAcC,QAQzCtD,KAAM,SAASJ,QAASC,QAASC,SAC/B,GAAI2D,OAAQ1D,IAKZ,IAJAA,KAAKF,QAAUR,OAAOQ,QAASE,KAAKI,UAEb,gBAAZP,WACTA,QAAUT,SAASoB,cAAcX,UAC/B,OAASA,QAAb,CAGA,GAAIE,SAAUA,SAAWH,SAASG,QAE9B2B,MAAQ,GAAIiC,MAEhBjC,OAAMkC,OAAS,WACbF,MACGG,kBAAkBhE,SAClBiE,QAAQjE,SACRkE,YAAYhE,SAIf2D,MAAM5D,QAAQG,KAAK+D,KAAKN,OAAOO,QAIjCvC,MAAMwC,IAAMrE,QAAQqE,MAGtBJ,QAAS,SAASjE,SAEhB,GAAIsE,SAAU/E,SAASkC,cAAc,MACrC6C,SAAQ5C,UAAY,mBACpB4C,QAAQnC,UAAY,4CAGpB,IAAIoB,QAAShE,SAASkC,cAAc,UAChC8C,gBAAkBhF,SAASkC,cAAc,MA4B7C,OA3BA8C,iBAAgB7C,UAAY,2BAC5B6C,gBAAgB5C,YAAY4B,QAG5BpD,KAAKqE,UAAYjF,SAASkC,cAAc,OACxCtB,KAAKqE,UAAU9C,UAAY,qBAG3BvB,KAAKqE,UAAU7C,YAAY2C,SAC3BnE,KAAKqE,UAAU7C,YAAY4C,iBAG3BvE,QAAQyE,WAAWC,aAAavE,KAAKqE,UAAWxE,SAGhDG,KAAKmE,QAAU,GAAI7D,SAAQ6D,SAC3BnE,KAAKoD,OAAS,GAAIR,QAAOQ,QACvBoB,WAAW,EACXrB,gBAAiBnD,KAAKF,QAAQqD,kBAGhCnD,KAAKoD,OAAOqB,SAASzE,KAAK0B,MAAMgD,YAChC1E,KAAKoD,OAAOuB,UAAU3E,KAAK0B,MAAMkD,aACjC5E,KAAKoD,OAAOV,IAAI1C,KAAK0B,OACrB1B,KAAKoD,OAAOyB,aAAa7E,KAAK0B,OAC9B1B,KAAK0B,MAAMoD,YAEJ9E,MAGT6D,kBAAmB,SAASkB,YAC1B,GAAIC,OAAQD,WAAWC,MACnBC,OAASF,WAAWE,OACpBC,SAAW,EACXC,SAAW,EACXC,OAAS,EACTC,OAAS,CAET,QAASrF,KAAKF,QAAQmD,UAAYjD,KAAKF,QAAQmD,SAAW+B,QAC5DI,OAAUpF,KAAKF,QAAQmD,SAAW+B,OAEhC,OAAShF,KAAKF,QAAQoD,WAAalD,KAAKF,QAAQoD,UAAY+B,SAC9DI,OAAUrF,KAAKF,QAAQoD,UAAY+B,QAErCC,SAAWI,KAAKC,IAAIH,OAAQC,QAE5BD,OAAS,EACTC,OAAS,EACL,OAASrF,KAAKF,QAAQiD,UAAY/C,KAAKF,QAAQiD,SAAWiC,QAC5DI,OAAUpF,KAAKF,QAAQiD,SAAWiC,OAEhC,OAAShF,KAAKF,QAAQkD,WAAahD,KAAKF,QAAQkD,UAAYiC,SAC9DI,OAAUrF,KAAKF,QAAQkD,UAAYiC,QAErCE,SAAWG,KAAKE,IAAIJ,OAAQC,OAE5B,IAAII,OAAQN,SAAWD,QAoCvB,OAlCAF,QAASS,MACTR,QAAUQ,MAEVzF,KAAK0B,MAAQ,GAAIrC,QAAOsE,MAAMoB,YAE5BW,YAAY,EACZC,SAAS,EACTC,eAAe,EACfC,eAAe,EACfC,cAAc,EACdC,cAAc,EACdC,cAAc,EACdC,gBAAgB,EAChBC,aAAa,EACbC,YAAY,IAEdnG,KAAK0B,MAAM0E,UAAUX,OACrBzF,KAAK0B,MAAM2E,UAAUZ,OAGrBzF,KAAKsG,YAAc,GAAIjH,QAAOsE,MAAMoB,YAElCW,YAAY,EACZC,SAAS,EACTC,eAAe,EACfC,eAAe,EACfC,cAAc,EACdC,cAAc,EACdC,cAAc,EACdC,gBAAgB,EAChBC,aAAa,EACbC,YAAY,IAGPnG,MAGT+D,YAAa,SAAShE,SACpBC,KAAKD,UAEL,KAAK,GAAIwG,QAAQxG,SAAS,CACxB,GAAIyG,QAASzG,QAAQwG,MACjBzG,QAAUE,KAAKF,QAAQC,QAAQwG,KAG/BzG,YAAY,GAGXC,QAAQJ,eAAe4G,QAC5BvG,KAAKD,QAAQwG,MAAQ,GAAIC,QAAOxG,KAAMF,YAI1C2G,UAAW,SAASF,MAClB,MAAOvG,MAAKD,QAAQwG,OAGtBG,YAAa,WACX,GAAIrC,WAAYrE,KAAKqE,UAEjB3C,MAAQ,GAAIiC,MAChBjC,OAAMkC,OAAS,WACbS,UAAUC,WAAWC,aAAa7C,MAAO2C,YAG3C3C,MAAMwC,IAAMlE,KAAK2G,iBAQnBA,cAAe,WACb,MAAO3G,MAAK0B,MAAMkF,aAGpBC,oBAAqB,SAAS/G,SAC5B,MAAOE,MAAKsG,YAAYM,UAAU9G,YAKrCX,OAAQA,OAAOC,SAAUC,QCzY3B,SAAUF,OAAQC,SAAUQ,SAAUP,QACrC,YAEAO,UAASG,QAAiB,QAAIH,SAASM,OAAOZ,QAC5Ce,WAAY,WACVL,KAAK8G,eAEL9G,KAAK+G,oBACL/G,KAAKgH,0BAELhH,KAAKiH,uBACLjH,KAAKkH,6BAELlH,KAAKmH,iBAELnH,KAAKG,SAAS+B,iBAAiB,eAAgBlC,KAAKoH,eAAepD,KAAKhE,QAG1EqH,OAAQ,WAC+B,IAAjCrH,KAAK+G,iBAAiBO,SAI1BtH,KAAKiH,oBAAoBM,KAAKvH,KAAKwH,cACnCxH,KAAKkH,0BAA0BK,KAAKvH,KAAKyH,oBAEzCzH,KAAKwH,aAAexH,KAAK+G,iBAAiBW,MAC1C1H,KAAKyH,mBAAqBzH,KAAKgH,uBAAuBU,MAGtD1H,KAAK2H,YAAY3H,KAAKwH,cACtBxH,KAAK4H,kBAAkB5H,KAAKyH,oBAC5BzH,KAAK6H,iBAIL7H,KAAKG,SAASmD,cAAc,sBAG9BwE,UAAW,WAC+B,IAApC9H,KAAKiH,oBAAoBK,SAK7BtH,KAAK+G,iBAAiBQ,KAAKvH,KAAKwH,cAChCxH,KAAKgH,uBAAuBO,KAAKvH,KAAKyH,oBAEtCzH,KAAKwH,aAAexH,KAAKiH,oBAAoBS,MAC7C1H,KAAKyH,mBAAqBzH,KAAKkH,0BAA0BQ,MAEzD1H,KAAK2H,YAAY3H,KAAKwH,cACtBxH,KAAK4H,kBAAkB5H,KAAKyH,oBAC5BzH,KAAK6H,iBAIL7H,KAAKG,SAASmD,cAAc,sBAG9BwD,aAAc,WACZ,GAAIzF,aAAcrB,KAAKG,SAASgE,QAAQ/C,mBAexC,OAbApB,MAAK+H,WAAa1G,YAAYI,cAC5BC,MAAO,OACPI,UAAU,IAGZ9B,KAAKgI,cAAgB3G,YAAYI,cAC/BC,MAAO,UACPI,UAAU,IAGZ9B,KAAK+H,WAAW7F,iBAAiB,QAASlC,KAAKqH,OAAOrD,KAAKhE,OAC3DA,KAAKgI,cAAc9F,iBAAiB,QAASlC,KAAK8H,UAAU9D,KAAKhE,OAE1DA,MAGT6H,eAAgB,WACd7H,KAAK+H,WAAW9F,QAA0C,IAAjCjC,KAAK+G,iBAAiBO,QAC/CtH,KAAKgI,cAAc/F,QAA6C,IAApCjC,KAAKiH,oBAAoBK,SAGvDH,eAAgB,WACd,GACIzF,OAAQ,GAAIiC,MAChBjC,OAAMwC,IAAMlE,KAAKG,SAASwG,eAE1B,IAAIL,aAAc,GAAI3C,MACtB2C,aAAYpC,IAAMlE,KAAKG,SAAS0G,sBAEhC7G,KAAKwH,aAAe9F,MACpB1B,KAAKyH,mBAAqBnB,aAG5Bc,eAAgB,WAEdpH,KAAK+G,iBAAiBQ,KAAKvH,KAAKwH,cAChCxH,KAAKgH,uBAAuBO,KAAKvH,KAAKyH,oBAEtCzH,KAAKmH,iBACLnH,KAAKiH,oBAAoBK,OAAS,EAClCtH,KAAKkH,0BAA0BI,OAAS,EACxCtH,KAAK6H,kBAIPF,YAAa,SAASjG,OACpB,GAAI0B,QAASpD,KAAKG,SAASiD,OAEvB6E,YAAc,GAAI5I,QAAOsE,MAAMjC,OAEjCgE,YAAY,EACZC,SAAS,EACTC,eAAe,EACfC,eAAe,EACfC,cAAc,EACdC,cAAc,EACdC,cAAc,EACdC,gBAAgB,EAChBC,aAAa,EACbC,YAAY,GAId/C,QAAOqB,SAAS/C,MAAMsD,OACtB5B,OAAOuB,UAAUjD,MAAMuD,QAGvBjF,KAAKG,SAASuB,MAAMiB,SACpB3C,KAAKG,SAASuB,MAAQuG,YACtB7E,OAAOV,IAAIuF,cAGbL,kBAAmB,SAAStB,aAE1B,GAAI2B,aAAc,GAAI5I,QAAOsE,MAAM2C,aAEjCZ,YAAY,EACZC,SAAS,EACTC,eAAe,EACfC,eAAe,EACfC,cAAc,EACdC,cAAc,EACdC,cAAc,EACdC,gBAAgB,EAChBC,aAAa,EACbC,YAAY,GAIdnG,MAAKG,SAASmG,YAAc2B,gBAG/B9I,OAAQC,SAAUQ,SAAUP,QC3J9B,SAAUF,OAAQC,SAAUQ,UAC3B,YAEAA,UAASG,QAAgB,OAAIH,SAASM,OAAOZ,QAC3Ce,WAAY,WACV,GAAIgB,aAAcrB,KAAKG,SAASgE,QAAQ/C,mBAExCpB,MAAKkI,WAAa7G,YAAYI,cAC5BC,MAAO,gBAGT1B,KAAKmI,YAAc9G,YAAYI,cAC7BC,MAAO,iBAGT1B,KAAKkI,WAAWhG,iBAAiB,QAASlC,KAAKoI,WAAWpE,KAAKhE,OAC/DA,KAAKmI,YAAYjG,iBAAiB,QAASlC,KAAKqI,YAAYrE,KAAKhE,QAGnEoI,WAAY,WACVpI,KAAKsI,OAAO,MAGdD,YAAa,WACXrI,KAAKsI,OAAO,KAGdA,OAAQ,SAAgBC,OACtB,GAEIpI,UAAWH,KAAKG,SAChBiD,OAASjD,SAASiD,OAClB1B,MAAQvB,SAASuB,MACjB4E,YAAcnG,SAASmG,WAC3BiC,QAAS7G,MAAM8G,WAAaD,OAAS,GAErC,IAAIvD,OAAOC,MACXA,QAASK,KAAKmD,IAAI/G,MAAMgD,WAAYY,KAAKoD,IAAIH,MAAMjD,KAAKqD,GAAG,MAAOrD,KAAKmD,IAAI/G,MAAMkD,YAAaU,KAAKsD,IAAIL,MAAMjD,KAAKqD,GAAG,MACrH3D,MAAQM,KAAKmD,IAAI/G,MAAMkD,YAAaU,KAAKoD,IAAIH,MAAMjD,KAAKqD,GAAG,MAAOrD,KAAKmD,IAAI/G,MAAMgD,WAAYY,KAAKsD,IAAIL,MAAMjD,KAAKqD,GAAG,MAEpHvF,OAAOqB,SAASO,OAChB5B,OAAOuB,UAAUM,QAEjBvD,MAAM4G,OAAOC,OACbjC,YAAYgC,OAAOC,OAEnBnF,OAAOyB,aAAanD,OACpBA,MAAMoD,YAENwB,YAAYxB,YAEZ1B,OAAOyF,YAEP1I,SAASmD,cAAc,oBAG1BnE,OAAQC,SAAUQ,SAAUP,QCxD9B,SAAUF,OAAQC,SAAUQ,SAAUP,QACrC,YAEA,IAAIyJ,UAAWzJ,OAAOwD,KAAKC,YAAYzD,OAAO0J,MAC5CC,QAAS,SAASC,KAChBjJ,KAAKkJ,UAAU,UAAWD,IAE1B,IACIE,YADSF,IAAI7F,OACD,GAGZgG,MAAQpJ,KAAKoJ,MAAQ,GAAK,EAC1BC,MAAQrJ,KAAKqJ,MAAQ,GAAK,EAC1BjE,OAASgE,MAAQpJ,KAAKoF,OACtBC,OAASgE,MAAQrJ,KAAKqF,MAE1B4D,KAAIxD,MAAML,OAAQC,QAGlB4D,IAAIK,UAAY,qBAChBtJ,KAAKuJ,eAAeN,KAGIvJ,SAApBuJ,IAAIO,YACNP,IAAIO,aAAaL,UAAWA,YACLzJ,SAAhBuJ,IAAIQ,UACXR,IAAIQ,SAAWN,UAAWA,YAG5BF,IAAIS,YAAc,qBAClB1J,KAAK2J,eAAeV,KACpBjJ,KAAK4J,YAAYX,KAGjBA,IAAIY,eAAiBV,UACrBF,IAAIS,YAAc,2BAClB1J,KAAK2J,eAAeV,KACpBjJ,KAAK4J,YAAYX,KAGjBA,IAAIxD,MAAM,EAAEL,OAAQ,EAAEC,SAGxBkE,eAAgB,SAASN,KACvB,GAAI7F,QAAS6F,IAAI7F,OACb0G,aAAe,EAiBfC,GAAKzE,KAAK0E,MAAMhK,KAAK0E,WAAa,EAAI1E,KAAKiK,WAC3CC,GAAK5E,KAAK0E,MAAMhK,KAAK0E,WAAa,GAClCyF,GAAK7E,KAAK0E,KAAKhK,KAAK0E,WAAa,GACjC0F,GAAK9E,KAAK0E,KAAKhK,KAAK0E,WAAa,GAAKtB,OAAO4B,MAAQhF,KAAK0E,WAAa1E,KAAKiK,YAE5EI,GAAK/E,KAAK0E,MAAMhK,KAAK4E,YAAc,EAAI5E,KAAKsK,UAC5CC,GAAKjF,KAAK0E,MAAMhK,KAAK4E,YAAc,GACnC4F,GAAKlF,KAAK0E,KAAKhK,KAAK4E,YAAc,GAClC6F,GAAKnF,KAAK0E,KAAKhK,KAAK4E,YAAc,GAAKxB,OAAO6B,OAASjF,KAAK4E,YAAc5E,KAAKsK,UAGnFrB,KAAIyB,SAASX,GAAIM,GAAID,GAAKL,GAAIQ,GAAKF,GAAKP,cAGxCb,IAAIyB,SAASX,GAAIQ,GAAIL,GAAKH,GAAIS,GAAKD,GAAKT,cAGxCb,IAAIyB,SAASP,GAAII,GAAIH,GAAKD,GAAIK,GAAKD,GAAKT,cAGxCb,IAAIyB,SAASX,GAAIS,GAAIJ,GAAKL,GAAIU,GAAKD,KAGrCb,eAAgB,SAASV,KACvBA,IAAI0B,YACJ1B,IAAI2B,QAAQ5K,KAAK0E,WAAW,GAAI1E,KAAK4E,YAAY,GACjDqE,IAAI4B,OAAO7K,KAAK0E,WAAW,GAAI1E,KAAK4E,YAAY,GAChDqE,IAAI4B,OAAO7K,KAAK0E,WAAW,EAAG1E,KAAK4E,YAAY,GAC/CqE,IAAI4B,QAAQ7K,KAAK0E,WAAW,EAAG1E,KAAK4E,YAAY,GAChDqE,IAAI4B,QAAQ7K,KAAK0E,WAAW,GAAI1E,KAAK4E,YAAY,GACjDqE,IAAI6B,UAGNlB,YAAa,SAASX,KAEpBA,IAAI0B,YACJ1B,IAAI2B,QAAQ5K,KAAK0E,WAAW,EAAI,EAAE,EAAI1E,KAAK0E,YAAa1E,KAAK4E,YAAY,GACzEqE,IAAI4B,QAAQ7K,KAAK0E,WAAW,EAAI,EAAE,EAAI1E,KAAK0E,WAAY1E,KAAK4E,YAAY,GACxEqE,IAAI6B,SACJ7B,IAAI0B,YACJ1B,IAAI2B,QAAQ5K,KAAK0E,WAAW,EAAI,EAAE,EAAI1E,KAAK0E,YAAa1E,KAAK4E,YAAY,GACzEqE,IAAI4B,QAAQ7K,KAAK0E,WAAW,EAAI,EAAE,EAAI1E,KAAK0E,WAAY1E,KAAK4E,YAAY,GACxEqE,IAAI6B,SAEJ7B,IAAI0B,YACJ1B,IAAI2B,QAAQ5K,KAAK0E,WAAW,GAAI1E,KAAK4E,YAAY,EAAI,EAAE,EAAI5E,KAAK4E,aAChEqE,IAAI4B,OAAO7K,KAAK0E,WAAW,GAAI1E,KAAK4E,YAAY,EAAI,EAAE,EAAI5E,KAAK4E,aAC/DqE,IAAI6B,SACJ7B,IAAI0B,YACJ1B,IAAI2B,QAAQ5K,KAAK0E,WAAW,GAAI1E,KAAK4E,YAAY,EAAI,EAAE,EAAI5E,KAAK4E,aAChEqE,IAAI4B,OAAO7K,KAAK0E,WAAW,GAAI1E,KAAK4E,YAAY,EAAI,EAAE,EAAI5E,KAAK4E,aAC/DqE,IAAI6B,WAIRlL,UAASG,QAAc,KAAIH,SAASM,OAAOZ,QAEzCyL,OAAQ,KACRC,OAAQ,KAGRC,cAAc,EACdC,WAAW,EACXC,SAAS,EAET/K,UAEE4C,UAAW,EACXD,SAAU,EAEVqI,MAAO,KAEPC,cAAc,GAGhBhL,WAAY,WACV,GAAIgB,aAAcrB,KAAKG,SAASgE,QAAQ/C,mBAExCpB,MAAKsL,WAAajK,YAAYI,cAC5BC,MAAO,SAET1B,KAAKuL,SAAWlK,YAAYI,cAC1BC,MAAO,SACPC,KAAM,UACNE,MAAM,IAER7B,KAAKwL,aAAenK,YAAYI,cAC9BC,MAAO,SACPC,KAAM,SACNE,MAAM,IAIR7B,KAAKsL,WAAWpJ,iBAAiB,QAASlC,KAAKyL,WAAWzH,KAAKhE,OAC/DA,KAAKuL,SAASrJ,iBAAiB,QAASlC,KAAK0L,gBAAgB1H,KAAKhE,OAClEA,KAAKwL,aAAatJ,iBAAiB,QAASlC,KAAK2L,aAAa3H,KAAKhE,OAGnEA,KAAKG,SAASiD,OAAOwI,GAAG,aAAc5L,KAAK6L,YAAY7H,KAAKhE,OAC5DA,KAAKG,SAASiD,OAAOwI,GAAG,aAAc5L,KAAK8L,YAAY9H,KAAKhE,OAC5DA,KAAKG,SAASiD,OAAOwI,GAAG,WAAY5L,KAAK+L,UAAU/H,KAAKhE,OACxDA,KAAKG,SAASiD,OAAOwI,GAAG,gBAAiB5L,KAAKgM,eAAehI,KAAKhE,OAClEA,KAAKG,SAASiD,OAAOwI,GAAG,iBAAkB5L,KAAKiM,gBAAgBjI,KAAKhE,OAEpEX,OAAOwD,KAAKqJ,YAAY7M,OAAOD,SAAU,UAAWY,KAAKmM,UAAUnI,KAAKhE,OACxEX,OAAOwD,KAAKqJ,YAAY7M,OAAOD,SAAU,QAASY,KAAKoM,QAAQpI,KAAKhE,OAEpEA,KAAKG,SAAS+B,iBAAiB,eAAgBlC,KAAK2L,aAAa3H,KAAKhE,QAIxEgM,eAAgB,SAASzI,OACvB,GAAKvD,KAAKqM,WAAV,CAIA,GAAIC,eAAgB/I,MAAMgJ,MAC1B,IAAID,gBAAkBtM,KAAKwM,SAA3B,CAGA,GAAIpJ,QAASpD,KAAKG,SAASiD,OACvBqJ,EAAIH,cAAcrC,UAAWyC,EAAIJ,cAAchC,SAC/CqC,EAAIL,cAAc5H,WAAYkI,EAAIN,cAAc1H,YAChDiI,KAAOzJ,OAAOsB,WAAaiI,EAC3BG,KAAO1J,OAAOwB,YAAcgI,CAExB,GAAJH,GACFH,cAAcS,IAAI,OAAQ,GACpB,EAAJL,GACFJ,cAAcS,IAAI,MAAO,GACvBN,EAAII,MACNP,cAAcS,IAAI,OAAQF,MACxBH,EAAII,MACNR,cAAcS,IAAI,MAAOD,MAE3B9M,KAAKG,SAASmD,cAAc,kBAI9B2I,gBAAiB,SAAS1I,OACxB,GAAKvD,KAAKqM,WAAV,CAIA,GAAIW,iBAAiB,EACjBV,cAAgB/I,MAAMgJ,MAC1B,IAAID,gBAAkBtM,KAAKwM,SAA3B,CAGA,GAAIpJ,QAASpD,KAAKG,SAASiD,OACvB6J,QAAU7J,OAAO8J,WAAW3J,MAAM4J,GAIlCC,MAHIH,QAAQR,EACRQ,QAAQP,EAELJ,cAAcrC,WACrBoD,KAAOf,cAAchC,SACrBuC,KAAOP,cAAcrC,UAAYqC,cAAc5H,WAC/CoI,KAAOR,cAAchC,SAAWgC,cAAc1H,WAQlD,IANI,OAAS5E,KAAKF,QAAQsL,QACb,EAAPgC,MAAYP,KAAOzJ,OAAOsB,YAAqB,EAAP2I,MAAYP,KAAO1J,OAAOwB,eACpEoI,gBAAiB,GAIV,EAAPI,MAAYP,KAAOzJ,OAAOsB,YAAcsI,eAAgB,CAC1D,GAAIM,YAAatN,KAAKsN,YAAc,CACpChB,eAAclG,UAAUkH,YAM1B,GAJW,EAAPF,MACFd,cAAciB,QAAQ,GAGb,EAAPF,MAAYP,KAAO1J,OAAOwB,aAAeoI,eAAgB,CAC3D,GAAIQ,YAAaxN,KAAKwN,YAAc,CACpClB,eAAcjG,UAAUmH,YAEf,EAAPH,MACFf,cAAcmB,OAAO,GAGnBnB,cAAc5H,WAAa1E,KAAKF,QAAQiD,UAC1CuJ,cAAcoB,aAAa1N,KAAKF,QAAQiD,UAEtCuJ,cAAc1H,YAAc5E,KAAKF,QAAQkD,WAC3CsJ,cAAcqB,cAAc3N,KAAKF,QAAQkD,WAG3ChD,KAAKsN,WAAahB,cAAcsB,YAChC5N,KAAKwN,WAAalB,cAAcuB,YAEhC7N,KAAKG,SAASmD,cAAc,kBAI9BuI,YAAa,SAAStI,OACpB,GAAKvD,KAAKqM,WAAV,CAIA,GAAIjJ,QAASpD,KAAKG,SAASiD,MAG3BA,QAAO0K,YACP,IAAIb,SAAU7J,OAAO8J,WAAW3J,MAAM4J,GAClCV,EAAIQ,QAAQR,EACZC,EAAIO,QAAQP,EACZqB,MAAQ,GAAI1O,QAAO2O,MAAMvB,EAAGC,GAG5BuB,aAAe7K,OAAO8K,iBACtBD,gBAAiBjO,KAAKwM,UAAYxM,KAAKwM,SAAS2B,cAAcJ,SAIlE3K,OAAOgL,sBACPpO,KAAKwM,SAAS/H,SAAS,GACvBzE,KAAKwM,SAAS7H,UAAU,GACxB3E,KAAKwM,SAASpG,UAAU,GACxBpG,KAAKwM,SAASnG,UAAU,GAExBrG,KAAK+K,OAAS0B,EACdzM,KAAKgL,OAAS0B,KAIhBZ,YAAa,SAASvI,OAEpB,GAAIvD,KAAKiL,aACP,MAAOjL,MAAKqO,mBAAmB9K,MAEjC,IAAI,OAASvD,KAAK+K,QAAU,OAAS/K,KAAKgL,OAA1C,CAIA,GAAI5H,QAASpD,KAAKG,SAASiD,OACvB6J,QAAU7J,OAAO8J,WAAW3J,MAAM4J,GAClCV,EAAIQ,QAAQR,EACZC,EAAIO,QAAQP,CAEhB1M,MAAKsO,gBAAgBtO,KAAK+K,OAAQ/K,KAAKgL,OAAQyB,EAAGC,KAGpD2B,mBAAoB,SAAS9K,OAC3B,GAAIH,QAASpD,KAAKG,SAASiD,OACvBmL,KAAOvO,KAAKwM,SAEZS,QAAU7J,OAAO8J,WAAW3J,MAAM4J,GAClCV,EAAIQ,QAAQR,EACZC,EAAIO,QAAQP,CAEX6B,MAAKC,MAASD,KAAKE,MACtBF,KAAKd,OAAOf,GACZ6B,KAAKhB,QAAQd,IAGfzM,KAAKkL,UAAauB,EAAI8B,KAAKC,KAAOD,KAAKvJ,MAAQ,EAC/ChF,KAAKmL,QAAUuB,EAAI6B,KAAKE,IAAMF,KAAKtJ,OAAS,EAE5CjF,KAAKsO,gBACHhJ,KAAKC,IAAIgJ,KAAKC,KAAM/B,GACpBnH,KAAKC,IAAIgJ,KAAKE,IAAK/B,GACnBpH,KAAKE,IAAI+I,KAAKC,KAAKD,KAAKvJ,MAAOyH,GAC/BnH,KAAKE,IAAI+I,KAAKE,IAAIF,KAAKtJ,OAAQyH,KAKnCX,UAAW,WACT,GAAI,OAAS/L,KAAK+K,QAAU,OAAS/K,KAAKgL,OAA1C,CAIA,GAAI5H,QAASpD,KAAKG,SAASiD,MAC3BpD,MAAKwM,SAAS1H,YACd1B,OAAOsL,gBAAgB1O,KAAKwM,UAC5BpJ,OAAO0K,aAEP9N,KAAK+K,OAAS,KACd/K,KAAKgL,OAAS,OAGhBmB,UAAW,SAAS5I,QACd,IAAUvD,KAAKF,QAAQuL,cAAgB9H,MAAMoL,UAAY3O,KAAKF,QAAQuL,cAAgBrL,KAAKiL,eAI/FjL,KAAKiL,cAAe,EACpBjL,KAAKG,SAASiD,OAAOgL,sBACrBpO,KAAKwM,SAAS/H,SAAS,GACvBzE,KAAKwM,SAAS7H,UAAU,GACxB3E,KAAKwM,SAASpG,UAAU,GACxBpG,KAAKwM,SAASnG,UAAU,GACxBrG,KAAKwM,SAASiB,OAAO,GACrBzN,KAAKwM,SAASe,QAAQ,KAGxBnB,QAAS,SAAS7I,QACZ,IAAUvD,KAAKF,QAAQuL,cAAgB9H,MAAMoL,UAAY3O,KAAKF,QAAQuL,cAAiBrL,KAAKiL,eAIhGjL,KAAKiL,cAAe,EACpBjL,KAAK+K,OAAS,EACd/K,KAAKgL,OAAS,EACdhL,KAAK+L,cAGP6C,WAAY,SAASnC,EAAGC,EAAG1H,MAAOC,OAAQ4J,gBACnC7O,KAAKqM,YACRrM,KAAK8O,eAEFD,eAGH7O,KAAKwM,SAASO,KACZyB,KAAQ/B,EACRgC,IAAO/B,EACP1H,MAASA,MACTC,OAAUA,SANZjF,KAAKsO,gBAAgB7B,EAAGC,EAAGD,EAAEzH,MAAO0H,EAAEzH,OAUxC,IAAI7B,QAASpD,KAAKG,SAASiD,MAC3BA,QAAO2L,aAAa/O,KAAKwM,UACzBxM,KAAKwM,SAAS1H,YACd1B,OAAOsL,gBAAgB1O,KAAKwM,UAC5BpJ,OAAO0K,aAEP9N,KAAKG,SAASmD,cAAc,gBAG9BmI,WAAY,WACLzL,KAAKqM,WAGRrM,KAAK2L,eAFL3L,KAAK8O,gBAKTpD,gBAAiB,WACf,GAAK1L,KAAKqM,cAKNrM,KAAKwM,SAASxH,MAAQ,GAAKhF,KAAKwM,SAASvH,OAAS,GAAtD,CAGA,GAAIvB,OAAQ1D,KACRG,SAAWH,KAAKG,SAChBiD,OAASjD,SAASiD,OAClBgI,MAAQpL,KAAKG,SAASmG,YAAY5B,WAAatB,OAAOsB,WACtDsK,YAAc,CAGlBhP,MAAKwM,SAASyC,SAAU,CAGxB,IAAIvN,OAAQ,GAAIiC,OACZ2C,YAAc,GAAI3C,MAEtBjC,OAAMkC,OAAS,WAIb,GAHAoL,gBAGIhP,KAAKiF,OAAS,GAAKjF,KAAKgF,MAAQ,GAApC,CAIA,GAAIiD,aAAc,GAAI5I,QAAOsE,MAAM3D,MAEjC0F,YAAY,EACZC,SAAS,EACTC,eAAe,EACfC,eAAe,EACfC,cAAc,EACdC,cAAc,EACdC,cAAc,EACdC,gBAAgB,EAChBC,aAAa,EACbC,YAAY,IAGVnB,MAAQhF,KAAKgF,MACbC,OAASjF,KAAKiF,MAGlB7B,QAAOqB,SAASO,OAChB5B,OAAOuB,UAAUM,QAGjBvB,MAAMvD,SAASuB,MAAMiB,SACrBe,MAAMvD,SAASuB,MAAQuG,YACvB7E,OAAOV,IAAIuF,aAEQ,GAAf+G,aACF7O,SAASmD,cAAc,kBAI3BgD,YAAY1C,OAAS,WAGnB,GAFAoL,gBAEIhP,KAAKiF,OAAS,GAAKjF,KAAKgF,MAAQ,GAApC,CAIA,GAAIkK,mBAAoB,GAAI7P,QAAOsE,MAAM3D,MAEvC0F,YAAY,EACZC,SAAS,EACTC,eAAe,EACfC,eAAe,EACfC,cAAc,EACdC,cAAc,EACdC,cAAc,EACdC,gBAAgB,EAChBC,aAAa,EACbC,YAAY,GAIdzC,OAAMvD,SAASmG,YAAc4I,kBAEV,GAAfF,aACF7O,SAASmD,cAAc,kBAI3B5B,MAAMwC,IAAMd,OAAOwD,WACjB4H,KAAMxO,KAAKwM,SAASvC,UACpBwE,IAAKzO,KAAKwM,SAASlC,SACnBtF,MAAOhF,KAAKwM,SAAS9H,WACrBO,OAAQjF,KAAKwM,SAAS5H,cAGxB0B,YAAYpC,IAAMlE,KAAKG,SAASmG,YAAYM,WAC1C4H,KAAMxO,KAAKwM,SAASvC,UAAYmB,MAChCqD,IAAKzO,KAAKwM,SAASlC,SAAWc,MAC9BpG,MAAOhF,KAAKwM,SAAS9H,WAAa0G,MAClCnG,OAAQjF,KAAKwM,SAAS5H,YAAcwG,UAMxCiB,SAAU,WACR,MAAyB3M,UAAlBM,KAAKwM,UAIdsC,aAAc,WACZ9O,KAAKwM,SAAW,GAAI1D,WAClBqG,KAAM,cACNhJ,YAAY,EACZiJ,QAAS,OACTC,QAAS,MAITC,YAAa,OACbC,WAAY,EACZC,oBAAoB,EACpB1J,cAAc,EACd2J,kBAAkB,IAGhB,OAASzP,KAAKF,QAAQsL,OACxBpL,KAAKwM,SAASO,IAAI,kBAAkB,GAGtC/M,KAAKG,SAASiD,OAAOV,IAAI1C,KAAKwM,UAC9BxM,KAAKG,SAASiD,OAAOsM,cAAgB,YAErC1P,KAAKsL,WAAW/I,QAAO,GACvBvC,KAAKuL,SAAS1J,MAAK,GACnB7B,KAAKwL,aAAa3J,MAAK,IAIzB8J,aAAc,WACRjM,SAAcM,KAAKwM,WAGvBxM,KAAKwM,SAAS7J,SACd3C,KAAKwM,SAAW9M,OAEhBM,KAAKsL,WAAW/I,QAAO,GACvBvC,KAAKuL,SAAS1J,MAAK,GACnB7B,KAAKwL,aAAa3J,MAAK,GAEvB7B,KAAKG,SAASiD,OAAOsM,cAAgB,UAErC1P,KAAKG,SAASmD,cAAc,iBAG9BgL,gBAAiB,SAASqB,MAAOC,MAAOC,IAAKC,KAC3C,GAAI1M,QAASpD,KAAKG,SAASiD,OAEvB2M,QAAWF,IAAMF,MACjBK,QAAUD,QACVE,OAAUH,IAAMF,MAChBM,MAAQD,OAERlN,SAAWuC,KAAKC,KAAKvF,KAAKF,QAAQiD,SAAUK,OAAOsB,YACnD1B,UAAYsC,KAAKC,KAAKvF,KAAKF,QAAQkD,UAAWI,OAAOwB,aAGrDuL,MAAQ7K,KAAKC,IAAIoK,MAAOE,KACxBO,OAAS9K,KAAKE,IAAImK,MAAOE,KACzBQ,KAAO/K,KAAKC,IAAIqK,MAAOE,KACvBQ,QAAUhL,KAAKE,IAAIoK,MAAOE,IAG9BK,OAAQ7K,KAAKE,IAAI,EAAG2K,OACpBC,OAAS9K,KAAKC,IAAInC,OAAOsB,WAAY0L,QACrCC,KAAO/K,KAAKE,IAAI,EAAG6K,MACnBC,QAAUhL,KAAKC,IAAInC,OAAOwB,YAAa0L,SAGlBvN,SAAjBqN,OAASD,QACPJ,QACFK,OAASD,MAAQpN,SAEjBoN,MAAQC,OAASrN,UAEAC,UAAjBsN,QAAUD,OACRJ,OACFK,QAAUD,KAAOrN,UAEjBqN,KAAOC,QAAUtN,WAIT,EAARmN,QAEFC,QAAU9K,KAAKmD,IAAI0H,OACnBA,MAAQ,GAENC,OAAShN,OAAOsB,aAElByL,OAAUC,OAAShN,OAAOsB,WAC1B0L,OAAShN,OAAOsB,YAEP,EAAP2L,OAEFC,SAAWhL,KAAKmD,IAAI4H,MACpBA,KAAO,GAELC,QAAUlN,OAAOwB,cAEnByL,MAASC,QAAUlN,OAAOwB,YAC1B0L,QAAUlN,OAAOwB,YAGnB,IAAII,OAAQoL,OAASD,MACjBlL,OAASqL,QAAUD,KACnBE,aAAevL,MAAQC,MAE3B,IAAIjF,KAAKF,QAAQsL,QAAUpL,KAAKF,QAAQsL,QAAUmF,aAAc,CAC9D,GAAInF,QAASpL,KAAKF,QAAQsL,KAO1B,IALIpL,KAAKiL,eACP+E,OAAShQ,KAAKkL,UACdgF,KAAOlQ,KAAKmL,SAGKC,MAAfmF,aAAsB,CACxB,GAAIC,UAAWvL,OAASmG,KACpB4E,UACFG,OAAUK,SAAWxL,OAEvBA,MAAQwL,aACH,IAAID,aAAenF,MAAO,CAC/B,GAAIqF,WAAYxL,QAAUmG,MAAQnG,OAASD,MACvCkL,QACFG,MAASI,UAAYxL,QAEvBA,OAASwL,UAWX,GARY,EAARN,QACFA,MAAQ,GAGC,EAAPE,OACFA,KAAO,GAGLF,MAAQnL,MAAQ5B,OAAOsB,WAAY,CACrC,GAAI8L,UAAWpN,OAAOsB,WAAayL,KACnClL,QAASuL,SAAWvL,OAASD,MAC7BA,MAAQwL,SACJN,OACFG,KAAOT,MAAQ3K,QAGnB,GAAIoL,KAAOpL,OAAS7B,OAAOwB,YAAa,CACtC,GAAI6L,WAAYrN,OAAOwB,YAAcyL,IACrCrL,OAAQA,MAAQyL,UAAYxL,OAC5BA,OAASwL,UACLT,SACFG,MAAQR,MAAQ3K,QAMtBhF,KAAKwM,SAASgC,KAAO2B,MACrBnQ,KAAKwM,SAASiC,IAAM4B,KACpBrQ,KAAKwM,SAASxH,MAAQA,MACtBhF,KAAKwM,SAASvH,OAASA,OAEvBjF,KAAKG,SAASiD,OAAO2L,aAAa/O,KAAKwM,UAEvCxM,KAAKG,SAASmD,cAAc,mBAG/BnE,OAAQC,SAAUQ,SAAUP,QCxqB9B,SAAUF,OAAQC,SAAUQ,UAC3B,YAEAA,UAASG,QAAc,KAAIH,SAASM,OAAOZ,QACzCc,UACEgC,SAAU,WACRpC,KAAKG,SAASuG,gBAIlBrG,WAAY,WACV,GAAIgB,aAAcrB,KAAKG,SAASgE,QAAQ/C,mBAExCpB,MAAK0Q,cAAgBrP,YAAYI,cAC/BC,MAAO,SAGT1B,KAAK0Q,cAAcxO,iBAAiB,QAASlC,KAAKF,QAAQsC,SAAS4B,KAAKhE,WAG3Eb,OAAQC,SAAUQ"}